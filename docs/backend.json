{
  "entities": {
    "Family": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Family",
      "type": "object",
      "description": "Represents a family account within the Memora application.",
      "properties": {
        "familyName": {
          "type": "string",
          "description": "The name of the family (e.g., 'The Smiths')."
        },
        "adminId": {
          "type": "string",
          "description": "Reference to User who is the administrator of this family."
        },
        "memberIds": {
          "type": "array",
          "description": "References to Users who are members of this family.",
          "items": {
            "type": "string"
          }
        },
        "subscriptionTier": {
          "type": "string",
          "description": "The subscription tier of the family ('free' or 'premium')."
        }
      },
      "required": [
        "familyName",
        "adminId",
        "memberIds",
        "subscriptionTier"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Memora application.",
      "properties": {
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "familyId": {
          "type": "string",
          "description": "Reference to Family the user belongs to. (Relationship: Family 1:N User)"
        },
        "avatarId": {
          "type": "string"
        }
      },
      "required": [
        "email",
        "displayName",
        "familyId"
      ]
    },
    "Story": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Story",
      "type": "object",
      "description": "Represents a family story within the Memora application.",
      "properties": {
        "familyId": {
          "type": "string",
          "description": "Reference to the Family to which this story belongs. (Relationship: Family 1:N Story)"
        },
        "title": {
          "type": "string",
          "description": "The title of the story."
        },
        "narrator": {
          "type": "string",
          "description": "The name of the family member narrating the story."
        },
        "audioUrl": {
          "type": "string",
          "description": "URL of the audio file in Firebase Storage."
        },
        "transcription": {
          "type": "string",
          "description": "The text transcription of the story."
        },
        "status": {
          "type": "string",
          "description": "The status of the story ('uploading', 'transcribing', 'completed')."
        },
        "associatedPhotoUrl": {
          "type": "string",
          "description": "URL of the associated photo in Firebase Storage."
        },
        "isDonated": {
          "type": "boolean",
          "description": "Indicates whether the story has been donated to Estudia Memora."
        }
      },
      "required": [
        "familyId",
        "title",
        "narrator",
        "audioUrl",
        "transcription",
        "status",
        "isDonated"
      ]
    },
    "MemoraBox": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MemoraBox",
      "type": "object",
      "description": "Represents a physical Memora Box device.",
      "properties": {
        "familyId": {
          "type": "string",
          "description": "Reference to the Family to which this box is linked. (Relationship: Family 1:N MemoraBox)"
        },
        "pairingCode": {
          "type": "string",
          "description": "Temporary 6-digit code for pairing the box."
        },
        "status": {
          "type": "string",
          "description": "The status of the box ('pending_pairing', 'active')."
        }
      },
      "required": [
        "familyId",
        "status"
      ]
    },
    "DonatedStory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DonatedStory",
      "type": "object",
      "description": "Represents a story donated to the Estudia Memora community.",
      "properties": {
        "storyId": {
          "type": "string",
          "description": "Reference to the original Story. (Relationship: Story 1:1 DonatedStory, optional)"
        },
        "anonTranscription": {
          "type": "string",
          "description": "The anonymized text of the story."
        }
      },
      "required": [
        "storyId",
        "anonTranscription"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. The document ID corresponds to the Firebase Auth UID."
        }
      },
      {
        "path": "/families/{familyId}",
        "definition": {
          "entityName": "Family",
          "schema": {
            "$ref": "#/backend/entities/Family"
          },
          "description": "Stores family account information."
        }
      },
      {
        "path": "/families/{familyId}/stories/{storyId}",
        "definition": {
          "entityName": "Story",
          "schema": {
            "$ref": "#/backend/entities/Story"
          },
          "description": "Stores stories associated with a family."
        }
      },
      {
        "path": "/families/{familyId}/memoraBoxes/{boxId}",
        "definition": {
          "entityName": "MemoraBox",
          "schema": {
            "$ref": "#/backend/entities/MemoraBox"
          },
          "description": "Stores information about Memora Box devices, nested under the family they belong to."
        }
      },
      {
        "path": "/donatedStories/{donatedStoryId}",
        "definition": {
          "entityName": "DonatedStory",
          "schema": {
            "$ref": "#/backend/entities/DonatedStory"
          },
          "description": "Stores anonymized stories donated to the Estudia Memora community."
        }
      }
    ]
  }
}
